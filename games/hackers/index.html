<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bangers&display=swap" rel="stylesheet">
    <title>Security Lab - HuyÃÄnh Minh VaÃÄng - K·ªπ s∆∞ ph·∫ßn m·ªÅm</title>
    <link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
    <link rel="manifest" href="favicon/site.webmanifest">
    <link rel="mask-icon" href="favicon/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">
    <link rel="stylesheet" href="style.css">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2405594346881842"
        crossorigin="anonymous"></script>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>üõ°Ô∏è Security Lab</h1>
            <p>M√¥i tr∆∞·ªùng gi·∫£ l·∫≠p t·∫•n c√¥ng web ƒë·ªÉ h·ªçc ph√≤ng ch·ªëng</p>
        </div>
        
        <div class="warning">
            <h3>‚ö†Ô∏è C·∫¢NH B√ÅO QUAN TR·ªåNG</h3>
            <p><strong>ƒê√¢y l√† m√¥i tr∆∞·ªùng lab gi√°o d·ª•c!</strong> T·∫•t c·∫£ d·ªØ li·ªáu ƒë∆∞·ª£c l∆∞u trong b·ªô nh·ªõ t·∫°m v√† s·∫Ω m·∫•t khi refresh trang. Kh√¥ng nh·∫≠p th√¥ng tin th·∫≠t!</p>
            <ul style="margin-top: 10px; margin-left: 20px;">
                <li>Ch·ªâ s·ª≠ d·ª•ng cho m·ª•c ƒë√≠ch h·ªçc t·∫≠p</li>
                <li>Kh√¥ng √°p d·ª•ng ki·∫øn th·ª©c n√†y ƒë·ªÉ t·∫•n c√¥ng h·ªá th·ªëng th·∫≠t</li>
                <li>Lu√¥n s·ª≠ d·ª•ng d·ªØ li·ªáu gi·∫£ khi test</li>
            </ul>
        </div>
        
        <div class="main-content">
            <div class="section">
                <h3>üéØ M·ª•c ti√™u gi·∫£ l·∫≠p (Fake Login)</h3>
                <form id="loginForm">
                    <div class="form-group">
                        <label for="username">T√™n ƒëƒÉng nh·∫≠p:</label>
                        <input type="text" id="username" name="username" placeholder="Nh·∫≠p t√™n ƒëƒÉng nh·∫≠p gi·∫£">
                    </div>
                    <div class="form-group">
                        <label for="password">M·∫≠t kh·∫©u:</label>
                        <input type="password" id="password" name="password" placeholder="Nh·∫≠p m·∫≠t kh·∫©u gi·∫£">
                    </div>
                    <div class="form-group">
                        <label for="creditCard">Th·∫ª t√≠n d·ª•ng (gi·∫£):</label>
                        <input type="text" id="creditCard" name="creditCard" placeholder="1234-5678-9012-3456">
                    </div>
                    <button type="submit" class="btn">ƒêƒÉng nh·∫≠p</button>
                </form>
            </div>
            
            <div class="section">
                <h3>üïµÔ∏è B·∫£ng ƒëi·ªÅu khi·ªÉn t·∫•n c√¥ng - Nh√≥m 1</h3>
                <div class="controls">
                    <button class="btn btn-danger" onclick="startKeylogger()">B·∫≠t Keylogger</button>
                    <button class="btn btn-danger" onclick="stealFormData()">ƒê√°nh c·∫Øp Form</button>
                    <button class="btn btn-danger" onclick="collectBrowserInfo()">Thu th·∫≠p Info</button>
                    <button class="btn btn-danger" onclick="sessionHijack()">Session Hijack</button>
                </div>
                <div class="status safe" id="status">H·ªá th·ªëng an to√†n</div>
            </div>
            
            <div class="section">
                <h3>üíÄ T·∫•n c√¥ng n√¢ng cao - Nh√≥m 2</h3>
                <div class="controls">
                    <button class="btn btn-danger" onclick="clickjacking()">Clickjacking</button>
                    <button class="btn btn-danger" onclick="xssAttack()">XSS Attack</button>
                    <button class="btn btn-danger" onclick="csrfAttack()">CSRF Attack</button>
                    <button class="btn btn-danger" onclick="socialEngineering()">Social Engineering</button>
                </div>
            </div>
            
            <div class="section">
                <h3>üéØ T·∫•n c√¥ng chuy√™n s√¢u - Nh√≥m 3</h3>
                <div class="controls">
                    <button class="btn btn-danger" onclick="cryptoMining()">Crypto Mining</button>
                    <button class="btn btn-danger" onclick="dataExfiltration()">Data Exfiltration</button>  
                    <button class="btn btn-danger" onclick="backdoorInstall()">Install Backdoor</button>
                    <button class="btn btn-danger" onclick="networkScan()">Network Scan</button>
                </div>
            </div>
            
            <div class="section">
                <h3>üîß C√¥ng c·ª• ƒëi·ªÅu khi·ªÉn</h3>
                <div class="controls">
                    <button class="btn" onclick="clearLogs()">X√≥a Log</button>
                    <button class="btn" onclick="exportData()">Export Data</button>
                    <button class="btn" onclick="resetLab()">Reset Lab</button>
                </div>
            </div>
            
            <div class="section full-width">
                <h3>üìä Log ho·∫°t ƒë·ªông ƒë·ªôc h·∫°i (Gi·∫£ l·∫≠p)</h3>
                <div class="log-area" id="logArea">
                    <div>[SYSTEM] Security Lab ƒë√£ kh·ªüi ƒë·ªông</div>
                    <div>[INFO] M√¥i tr∆∞·ªùng lab an to√†n - T·∫•t c·∫£ d·ªØ li·ªáu l√† gi·∫£</div>
                </div>
            </div>
            
            <div class="section">
                <h3>üõ°Ô∏è Bi·ªán ph√°p ph√≤ng ch·ªëng n√¢ng cao</h3>
                <div class="controls">
                    <button class="btn" onclick="enableCSP()">B·∫≠t CSP</button>
                    <button class="btn" onclick="blockMaliciousRequests()">Ch·∫∑n Request</button>
                    <button class="btn" onclick="sanitizeInputs()">L√†m s·∫°ch Input</button>
                    <button class="btn" onclick="enableWAF()">B·∫≠t WAF</button>
                    <button class="btn" onclick="enableMFA()">B·∫≠t 2FA</button>
                    <button class="btn" onclick="enableHoneypot()">Deploy Honeypot</button>
                </div>
            </div>
            
            <div class="section">
                <h3>üìà Th·ªëng k√™ t·∫•n c√¥ng chi ti·∫øt</h3>
                <div id="stats">
                    <p>Keystrokes captured: <span id="keystrokeCount">0</span></p>
                    <p>Forms intercepted: <span id="formCount">0</span></p>
                    <p>Data leaked: <span id="dataCount">0</span> bytes</p>
                    <p>Blocked attempts: <span id="blockedCount">0</span></p>
                    <p>XSS attempts: <span id="xssCount">0</span></p>
                    <p>Session hijacks: <span id="sessionCount">0</span></p>
                    <p>Mining threads: <span id="miningCount">0</span></p>
                    <p>Network probes: <span id="networkCount">0</span></p>
                </div>
            </div>
            
            <div class="section full-width">
                <h3>üéØ Fake Banking Interface (M·ª•c ti√™u m√¥ ph·ªèng)</h3>
                <div style="background: #f0f8ff; padding: 20px; border-radius: 8px; border: 2px solid #4169e1;">
                    <h4>üè¶ SecureBank Login</h4>
                    <form id="bankingForm">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px;">
                            <div class="form-group">
                                <label>Account Number:</label>
                                <input type="text" id="accountNumber" placeholder="123456789" autocomplete="off">
                            </div>
                            <div class="form-group">
                                <label>PIN:</label>
                                <input type="password" id="pin" placeholder="****" autocomplete="off">
                            </div>
                            <div class="form-group">
                                <label>Credit Card:</label>
                                <input type="text" id="creditCardFull" placeholder="4532-1234-5678-9012" autocomplete="off">
                            </div>
                            <div class="form-group">
                                <label>CVV:</label>
                                <input type="password" id="cvv" placeholder="123" autocomplete="off">
                            </div>
                        </div>
                        <button type="submit" class="btn" style="margin-top: 15px;">Login to Bank</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Bi·∫øn to√†n c·ª•c ƒë·ªÉ theo d√µi
        let keyloggerActive = false;
        let formInterceptActive = false;
        let xssActive = false;
        let miningActive = false;
        let backdoorActive = false;
        let capturedData = [];
        let stats = {
            keystrokes: 0,
            forms: 0,
            dataBytes: 0,
            blocked: 0,
            xss: 0,
            sessions: 0,
            mining: 0,
            network: 0
        };

        // H√†m log an to√†n
        function logActivity(message, type = 'INFO') {
            const logArea = document.getElementById('logArea');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] [${type}] ${message}`;
            logArea.innerHTML += `<div>${logEntry}</div>`;
            logArea.scrollTop = logArea.scrollHeight;
        }

        // Gi·∫£ l·∫≠p Keylogger
        function startKeylogger() {
            if (keyloggerActive) {
                logActivity('Keylogger ƒë√£ ƒëang ho·∫°t ƒë·ªông', 'WARNING');
                return;
            }
            
            keyloggerActive = true;
            document.getElementById('status').className = 'status danger';
            document.getElementById('status').textContent = 'C·∫¢NH B√ÅO: Keylogger ƒëang ho·∫°t ƒë·ªông!';
            
            logActivity('Keylogger ƒë√£ ƒë∆∞·ª£c k√≠ch ho·∫°t', 'ATTACK');
            
            document.addEventListener('keydown', function(e) {
                if (keyloggerActive) {
                    const keyData = {
                        key: e.key,
                        timestamp: Date.now(),
                        target: e.target.tagName,
                        targetId: e.target.id || 'unknown'
                    };
                    
                    capturedData.push(keyData);
                    stats.keystrokes++;
                    stats.dataBytes += JSON.stringify(keyData).length;
                    
                    logActivity(`Key captured: ${e.key} on ${e.target.tagName}#${e.target.id}`, 'KEYLOG');
                    updateStats();
                    
                    // Gi·∫£ l·∫≠p g·ª≠i d·ªØ li·ªáu (kh√¥ng th·ª±c s·ª± g·ª≠i)
                    if (stats.keystrokes % 10 === 0) {
                        logActivity(`Batch sent: ${stats.keystrokes} keystrokes to malicious-server.com`, 'ATTACK');
                    }
                }
            });
        }

        // Gi·∫£ l·∫≠p ƒë√°nh c·∫Øp d·ªØ li·ªáu form
        function stealFormData() {
            formInterceptActive = true;
            logActivity('Form data interceptor activated', 'ATTACK');
            
            const forms = document.querySelectorAll('form');
            forms.forEach(form => {
                form.addEventListener('submit', function(e) {
                    if (formInterceptActive) {
                        e.preventDefault();
                        
                        const formData = new FormData(form);
                        const data = {};
                        for (let [key, value] of formData.entries()) {
                            data[key] = value;
                        }
                        
                        capturedData.push({
                            type: 'form',
                            data: data,
                            timestamp: Date.now(),
                            url: window.location.href
                        });
                        
                        stats.forms++;
                        stats.dataBytes += JSON.stringify(data).length;
                        
                        logActivity(`Form data stolen: ${Object.keys(data).join(', ')}`, 'ATTACK');
                        logActivity(`Sensitive data sent to attacker-site.com`, 'ATTACK');
                        updateStats();
                        
                        alert('‚ö†Ô∏è D·ªØ li·ªáu form ƒë√£ b·ªã ƒë√°nh c·∫Øp! (Gi·∫£ l·∫≠p)');
                    }
                });
            });
        }

        // Thu th·∫≠p th√¥ng tin tr√¨nh duy·ªát
        function collectBrowserInfo() {
            const browserInfo = {
                userAgent: navigator.userAgent,
                platform: navigator.platform,
                language: navigator.language,
                cookieEnabled: navigator.cookieEnabled,
                onLine: navigator.onLine,
                screen: `${screen.width}x${screen.height}`,
                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                url: window.location.href,
                referrer: document.referrer,
                timestamp: Date.now()
            };
            
            capturedData.push({
                type: 'browserInfo',
                data: browserInfo
            });
            
            stats.dataBytes += JSON.stringify(browserInfo).length;
            
            logActivity('Browser fingerprinting completed', 'ATTACK');
            logActivity(`Collected: ${Object.keys(browserInfo).length} data points`, 'ATTACK');
            logActivity('Browser info sent to tracking-server.com', 'ATTACK');
            
            updateStats();
        }

        // Session Hijacking
        function sessionHijack() {
            const fakeSessionData = {
                sessionId: 'sess_' + Math.random().toString(36).substr(2, 9),
                userId: 'user_' + Math.floor(Math.random() * 1000),
                authToken: 'token_' + Math.random().toString(36).substr(2, 16),
                userAgent: navigator.userAgent,
                ipAddress: '192.168.' + Math.floor(Math.random() * 255) + '.' + Math.floor(Math.random() * 255),
                timestamp: Date.now()
            };
            
            capturedData.push({
                type: 'sessionHijack',
                data: fakeSessionData
            });
            
            stats.sessions++;
            stats.dataBytes += JSON.stringify(fakeSessionData).length;
            
            logActivity('Session hijacking successful', 'ATTACK');
            logActivity(`Stolen session: ${fakeSessionData.sessionId}`, 'ATTACK');
            logActivity('Session data sent to command & control server', 'ATTACK');
            updateStats();
        }

        // XSS Attack
        function xssAttack() {
            if (xssActive) {
                logActivity('XSS payload already active', 'WARNING');
                return;
            }
            
            xssActive = true;
            stats.xss++;
            
            // T·∫°o popup gi·∫£ m·∫°o
            const maliciousDiv = document.createElement('div');
            maliciousDiv.id = 'xssPayload';
            maliciousDiv.innerHTML = `
                <div style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); 
                           background: white; border: 3px solid red; padding: 20px; z-index: 9999;
                           box-shadow: 0 0 20px rgba(0,0,0,0.5);">
                    <h3 style="color: red;">üö® SECURITY ALERT</h3>
                    <p>Your session has expired. Please re-enter your password:</p>
                    <input type="password" id="xssInput" placeholder="Enter password" style="width: 100%; padding: 8px; margin: 10px 0;">
                    <button onclick="stealXSSData()" style="background: red; color: white; padding: 8px 15px; border: none; cursor: pointer;">Verify</button>
                    <button onclick="closeXSS()" style="background: gray; color: white; padding: 8px 15px; border: none; cursor: pointer; margin-left: 10px;">Cancel</button>
                </div>
            `;
            document.body.appendChild(maliciousDiv);
            
            logActivity('XSS payload injected successfully', 'ATTACK');
            logActivity('Fake security alert displayed to user', 'ATTACK');
            updateStats();
        }

        // Clickjacking
        function clickjacking() {
            const overlay = document.createElement('div');
            overlay.id = 'clickjackOverlay';
            overlay.innerHTML = `
                <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                           background: rgba(0,0,0,0.1); z-index: 1000; cursor: pointer;"
                     onclick="handleClickjack(event)">
                    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
                               background: yellow; padding: 20px; border: 2px solid orange;">
                        <h3>üéÅ Congratulations!</h3>
                        <p>You've won a prize! Click anywhere to claim it!</p>
                        <small style="color: red;">(ƒê√¢y l√† clickjacking gi·∫£ m·∫°o)</small>
                    </div>
                </div>
            `;
            document.body.appendChild(overlay);
            
            logActivity('Clickjacking overlay deployed', 'ATTACK');
            logActivity('Invisible layer created to steal clicks', 'ATTACK');
            
            setTimeout(() => {
                const element = document.getElementById('clickjackOverlay');
                if (element) element.remove();
            }, 5000);
        }

        // CSRF Attack
        function csrfAttack() {
            const csrfData = {
                targetUrl: 'https://victim-bank.com/transfer',
                method: 'POST',
                params: {
                    to_account: '999999999',
                    amount: '1000000',
                    memo: 'Emergency transfer'
                },
                referer: window.location.href,
                timestamp: Date.now()
            };
            
            capturedData.push({
                type: 'csrf',
                data: csrfData
            });
            
            stats.dataBytes += JSON.stringify(csrfData).length;
            
            logActivity('CSRF attack initiated', 'ATTACK');
            logActivity('Forged request prepared for bank transfer', 'ATTACK');
            logActivity('Request would be sent using victim credentials', 'ATTACK');
            updateStats();
        }

        // Social Engineering
        function socialEngineering() {
            const techniques = [
                'Phishing email sent mimicking bank security team',
                'Fake tech support call scheduled',
                'Urgent security update notification prepared',
                'Fake prize notification created',
                'CEO impersonation email drafted'
            ];
            
            const selectedTechnique = techniques[Math.floor(Math.random() * techniques.length)];
            
            logActivity('Social engineering campaign launched', 'ATTACK');
            logActivity(`Technique: ${selectedTechnique}`, 'ATTACK');
            logActivity('Psychological manipulation in progress', 'ATTACK');
            
            // Hi·ªÉn th·ªã popup gi·∫£
            alert(`üìß PHISHING EMAIL:\n\n"Dear Customer,\n\nWe detected suspicious activity on your account. Please verify your identity immediately by clicking the link below:\n\nhttps://secure-bank-verification.fake.com\n\nFailure to verify within 24 hours will result in account suspension.\n\nBest regards,\nSecurity Team"\n\n‚ö†Ô∏è (ƒê√¢y l√† email l·ª´a ƒë·∫£o gi·∫£ m·∫°o!)`);
        }

        // Crypto Mining
        function cryptoMining() {
            if (miningActive) {
                logActivity('Crypto mining already running', 'WARNING');
                return;
            }
            
            miningActive = true;
            stats.mining++;
            
            logActivity('Crypto mining script injected', 'ATTACK');
            logActivity('Using victim CPU for cryptocurrency mining', 'ATTACK');
            
            // Gi·∫£ l·∫≠p tƒÉng CPU usage
            let miningThreads = 0;
            const miningInterval = setInterval(() => {
                if (miningActive && miningThreads < 10) {
                    miningThreads++;
                    logActivity(`Mining thread ${miningThreads} started - CPU usage: ${miningThreads * 10}%`, 'MINING');
                    
                    if (miningThreads >= 10) {
                        logActivity('Maximum mining capacity reached - Victim device slowdown', 'ATTACK');
                        clearInterval(miningInterval);
                    }
                }
            }, 1000);
            
            updateStats();
        }

        // Data Exfiltration
        function dataExfiltration() {
            const sensitiveData = {
                passwords: ['password123', 'admin2024', 'mySecret!'],
                emails: ['user@email.com', 'admin@company.com'],
                creditCards: ['4532-****-****-9012', '5555-****-****-4444'],
                documents: ['contract.pdf', 'financial_report.xlsx', 'personal_data.doc'],
                browserHistory: [
                    'https://banking.site.com',
                    'https://work.company.com',
                    'https://personal.email.com'
                ],
                fileSize: Math.floor(Math.random() * 1000000) + 100000
            };
            
            capturedData.push({
                type: 'dataExfiltration',
                data: sensitiveData,
                timestamp: Date.now()
            });
            
            stats.dataBytes += sensitiveData.fileSize;
            
            logActivity('Data exfiltration initiated', 'ATTACK');
            logActivity(`Collected ${sensitiveData.passwords.length} passwords`, 'ATTACK');
            logActivity(`Collected ${sensitiveData.creditCards.length} credit cards`, 'ATTACK');
            logActivity(`Exfiltrating ${Math.floor(sensitiveData.fileSize/1024)}KB of data`, 'ATTACK');
            logActivity('Data compressed and encrypted for transmission', 'ATTACK');
            
            updateStats();
        }

        // Backdoor Installation
        function backdoorInstall() {
            if (backdoorActive) {
                logActivity('Backdoor already installed', 'WARNING');
                return;
            }
            
            backdoorActive = true;
            
            const backdoorConfig = {
                type: 'persistent_backdoor',
                port: 4444,
                encryption: 'AES-256',
                persistence: 'registry_key',
                command_server: 'backdoor.malicious.com',
                installed_time: Date.now(),
                capabilities: [
                    'remote_command_execution',
                    'file_system_access',
                    'keylogger',
                    'screenshot_capture',
                    'webcam_access'
                ]
            };
            
            capturedData.push({
                type: 'backdoor',
                data: backdoorConfig
            });
            
            logActivity('Backdoor installation successful', 'ATTACK');
            logActivity(`Listening on port ${backdoorConfig.port}`, 'ATTACK');
            logActivity('Persistence mechanism established', 'ATTACK');
            logActivity('Connected to command & control server', 'ATTACK');
            logActivity('System compromised - Full remote access granted', 'ATTACK');
            
            updateStats();
        }

        // Network Scanning
        function networkScan() {
            stats.network++;
            
            const networkData = {
                local_ip: '192.168.1.' + Math.floor(Math.random() * 254 + 1),
                subnet: '192.168.1.0/24',
                open_ports: [22, 80, 443, 3306, 5432],
                discovered_hosts: [],
                services: {
                    'SSH': '192.168.1.10:22',
                    'HTTP': '192.168.1.1:80', 
                    'MySQL': '192.168.1.15:3306',
                    'PostgreSQL': '192.168.1.20:5432'
                }
            };
            
            // Gi·∫£ l·∫≠p qu√©t m·∫°ng
            logActivity('Network reconnaissance initiated', 'ATTACK');
            logActivity(`Scanning subnet: ${networkData.subnet}`, 'ATTACK');
            
            for (let i = 1; i <= 10; i++) {
                setTimeout(() => {
                    const host = `192.168.1.${Math.floor(Math.random() * 254 + 1)}`;
                    networkData.discovered_hosts.push(host);
                    logActivity(`Host discovered: ${host} - Ports: ${networkData.open_ports.join(', ')}`, 'SCAN');
                }, i * 500);
            }
            
            setTimeout(() => {
                logActivity('Network scan completed', 'ATTACK');
                logActivity(`${networkData.discovered_hosts.length} vulnerable hosts identified`, 'ATTACK');
                capturedData.push({
                    type: 'networkScan',
                    data: networkData
                });
            }, 5500);
            
            updateStats();
        }

        // H√†m h·ªó tr·ª£ cho XSS
        function stealXSSData() {
            const password = document.getElementById('xssInput').value;
            if (password) {
                logActivity(`XSS - Password stolen: ${password}`, 'ATTACK');
                capturedData.push({
                    type: 'xss_steal',
                    data: { password: password, timestamp: Date.now() }
                });
                stats.dataBytes += password.length;
                updateStats();
            }
            closeXSS();
        }

        function closeXSS() {
            const element = document.getElementById('xssPayload');
            if (element) element.remove();
            xssActive = false;
        }

        function handleClickjack(event) {
            logActivity('Clickjacking successful - User clicked on hidden element', 'ATTACK');
            logActivity('Unauthorized action executed', 'ATTACK');
            document.getElementById('clickjackOverlay').remove();
        }

        // Bi·ªán ph√°p ph√≤ng ch·ªëng n√¢ng cao
        function enableWAF() {
            logActivity('Web Application Firewall enabled', 'DEFENSE');
            logActivity('SQL Injection protection activated', 'DEFENSE');
            logActivity('XSS filtering enabled', 'DEFENSE');
            stats.blocked += 8;
            updateStats();
        }

        function enableMFA() {
            logActivity('Multi-Factor Authentication enabled', 'DEFENSE');
            logActivity('SMS verification required for login', 'DEFENSE');
            logActivity('Authentication bypass attempts blocked', 'DEFENSE');
            stats.blocked += 5;
            updateStats();
        }

        function enableHoneypot() {
            logActivity('Honeypot deployed successfully', 'DEFENSE');
            logActivity('Fake vulnerable services created', 'DEFENSE');
            logActivity('Attacker monitoring system active', 'DEFENSE');
            stats.blocked += 3;
            updateStats();
        }

        // Export data
        function exportData() {
            const exportData = {
                timestamp: new Date().toISOString(),
                stats: stats,
                capturedData: capturedData,
                summary: {
                    totalAttacks: stats.keystrokes + stats.forms + stats.xss + stats.sessions + stats.mining + stats.network,
                    totalDataLeaked: stats.dataBytes,
                    totalBlocked: stats.blocked
                }
            };
            
            const dataStr = JSON.stringify(exportData, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `security_lab_report_${Date.now()}.json`;
            a.click();
            
            logActivity('Security report exported successfully', 'SYSTEM');
        }

        // Reset lab
        function resetLab() {
            keyloggerActive = false;
            formInterceptActive = false;
            xssActive = false;
            miningActive = false;
            backdoorActive = false;
            capturedData = [];
            stats = {
                keystrokes: 0,
                forms: 0,
                dataBytes: 0,
                blocked: 0,
                xss: 0,
                sessions: 0,
                mining: 0,
                network: 0
            };
            
            document.getElementById('status').className = 'status safe';
            document.getElementById('status').textContent = 'H·ªá th·ªëng an to√†n';
            
            // Remove any remaining XSS elements
            const xssElement = document.getElementById('xssPayload');
            if (xssElement) xssElement.remove();
            
            const clickjackElement = document.getElementById('clickjackOverlay');
            if (clickjackElement) clickjackElement.remove();
            
            updateStats();
            clearLogs();
            logActivity('Security Lab reset completed', 'SYSTEM');
        }

        // C·∫≠p nh·∫≠t th·ªëng k√™
        function updateStats() {
            document.getElementById('keystrokeCount').textContent = stats.keystrokes;
            document.getElementById('formCount').textContent = stats.forms;
            document.getElementById('dataCount').textContent = stats.dataBytes;
            document.getElementById('blockedCount').textContent = stats.blocked;
            document.getElementById('xssCount').textContent = stats.xss;
            document.getElementById('sessionCount').textContent = stats.sessions;
            document.getElementById('miningCount').textContent = stats.mining;
            document.getElementById('networkCount').textContent = stats.network;
        }

        // Bi·ªán ph√°p ph√≤ng ch·ªëng c∆° b·∫£n
        function enableCSP() {
            logActivity('Content Security Policy enabled', 'DEFENSE');
            logActivity('Blocked inline scripts and external resources', 'DEFENSE');
            stats.blocked += 3;
            updateStats();
        }

        function blockMaliciousRequests() {
            logActivity('Malicious request blocker activated', 'DEFENSE');
            logActivity('Blocked requests to suspicious domains', 'DEFENSE');
            stats.blocked += 5;
            updateStats();
        }

        function sanitizeInputs() {
            logActivity('Input sanitization enabled', 'DEFENSE');
            logActivity('XSS protection activated', 'DEFENSE');
            keyloggerActive = false;
            formInterceptActive = false;
            xssActive = false;
            document.getElementById('status').className = 'status safe';
            document.getElementById('status').textContent = 'H·ªá th·ªëng ƒë∆∞·ª£c b·∫£o v·ªá';
            stats.blocked += 2;
            updateStats();
        }

        // X√≥a logs
        function clearLogs() {
            document.getElementById('logArea').innerHTML = `
                <div>[SYSTEM] Logs cleared</div>
                <div>[INFO] Security Lab ready for new simulation</div>
            `;
            capturedData = [];
            stats = { keystrokes: 0, forms: 0, dataBytes: 0, blocked: 0 };
            updateStats();
        }

        // Form submission handler
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            if (!formInterceptActive) {
                e.preventDefault();
                alert('‚úÖ ƒêƒÉng nh·∫≠p th√†nh c√¥ng! (Gi·∫£ l·∫≠p - D·ªØ li·ªáu an to√†n)');
                logActivity('Normal form submission - No data stolen', 'INFO');
            }
        });

        // Kh·ªüi t·∫°o
        logActivity('Security Lab initialized successfully', 'SYSTEM');
        logActivity('Ready for security testing', 'SYSTEM');
    </script>
</body>
</html>